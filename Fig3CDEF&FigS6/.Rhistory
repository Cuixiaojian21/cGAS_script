k50 <- readRDS("H:/2_1_all_scHi-C/1_2_collection_data/2023_Science_Lifelong/1_3_Supplementary_file/tmp/k50.rds")
install.packages("rliger")
k50 <- readRDS("H:/2_1_all_scHi-C/1_2_collection_data/2023_Science_Lifelong/1_3_Supplementary_file/tmp/k50.rds")
object <- convertOldLiger(object)
object <- convertOldLiger(readRDS("H:/2_1_all_scHi-C/1_2_collection_data/2023_Science_Lifelong/1_3_Supplementary_file/tmp/k50.rds"))
BiocManager::install("clusterProfiler")
install.packages("D:/0_1_software_package/R包/clusterProfiler_4.12.0.zip", repos = NULL, type = "win.binary")
library(clusterProfiler)
install('AnnotationDbi')
BiocManager::install("AnnotationDbi")
install.packages("D:/0_1_software_package/R包/AnnotationDbi_1.66.0.zip", repos = NULL, type = "win.binary")
library(clusterProfiler)
install.packages("D:/0_1_software_package/R包/Biostrings_2.72.1.zip", repos = NULL, type = "win.binary")
library(clusterProfiler)
install.packages("D:/0_1_software_package/R包/DOSE_3.30.1.zip", repos = NULL, type = "win.binary")
library(clusterProfiler)
install.packages("D:/0_1_software_package/R包/downloader_0.4.zip", repos = NULL, type = "win.binary")
install.packages("D:/0_1_software_package/R包/enrichplot_1.24.0.zip", repos = NULL, type = "win.binary")
install.packages("D:/0_1_software_package/R包/GOSemSim_2.30.0.zip", repos = NULL, type = "win.binary")
install.packages("D:/0_1_software_package/R包/gson_0.1.0.zip", repos = NULL, type = "win.binary")
install.packages("D:/0_1_software_package/R包/httr_1.4.7.zip", repos = NULL, type = "win.binary")
install.packages("D:/0_1_software_package/R包/igraph_2.0.3.zip", repos = NULL, type = "win.binary")
install.packages("D:/0_1_software_package/R包/magrittr_2.0.3.zip", repos = NULL, type = "win.binary")
install.packages("D:/0_1_software_package/R包/plyr_1.8.9.zip", repos = NULL, type = "win.binary")
install.packages("D:/0_1_software_package/R包/qvalue_2.36.0.zip", repos = NULL, type = "win.binary")
install.packages("D:/0_1_software_package/R包/rlang_1.1.4.zip", repos = NULL, type = "win.binary")
install.packages("D:/0_1_software_package/R包/tidyr_1.3.1.zip", repos = NULL, type = "win.binary")
install.packages("D:/0_1_software_package/R包/yulab.utils_0.1.4.zip", repos = NULL, type = "win.binary")
library(clusterProfiler)
install.packages("D:/0_1_software_package/R包/GO.db_3.19.1.tar.gz", repos = NULL, type = "source")
library(clusterProfiler)
install.packages("D:/0_1_software_package/R包/HDO.db_0.99.1.tar.gz", repos = NULL, type = "source")
library(clusterProfiler)
install.packages("D:/0_1_software_package/R包/fgsea_1.30.0.zip", repos = NULL, type = "win.binary")
library(clusterProfiler)
install.packages("D:/0_1_software_package/R包/GenomicFeatures_1.56.0.zip", repos = NULL, type = "win.binary")
library(TxDb.Hsapiens.UCSC.hg19.knownGene)
install.packages("D:/0_1_software_package/R包/TxDb.Hsapiens.UCSC.hg19.knownGene_3.2.2.tar.gz", repos = NULL, type = "source")
library(clusterProfiler)
library(TxDb.Hsapiens.UCSC.hg19.knownGene)
txdb <- TxDb.Hsapiens.UCSC.hg19.knownGene
library(org.Hs.eg.db)
install.packages("D:/0_1_software_package/R包/IRanges_2.38.0.zip", repos = NULL, type = "win.binary")
install.packages("D:/0_1_software_package/R包/TxDb.Hsapiens.UCSC.hg19.knownGene_3.2.2.tar.gz", repos = NULL, type = "source")
install.packages("D:/0_1_software_package/R包/TxDb.Hsapiens.UCSC.hg19.knownGene_3.2.2.tar.gz", repos = NULL, type = "source")
library(IRanges)
install.packages("D:/0_1_software_package/R包/TxDb.Hsapiens.UCSC.hg19.knownGene_3.2.2.tar.gz", repos = NULL, type = "source")
remove.packages("IRanges")
install.packages("D:/0_1_software_package/R包/IRanges_2.38.0.zip", repos = NULL, type = "win.binary")
install.packages("D:/0_1_software_package/R包/IRanges_2.38.0.zip", repos = NULL, type = "win.binary")
install.packages("D:/0_1_software_package/R包/TxDb.Hsapiens.UCSC.hg19.knownGene_3.2.2.tar.gz", repos = NULL, type = "source")
library(GenomicRanges)
detach("package:GenomicRanges", unload = TRUE)
remove.packages("GenomicRanges")
install.packages("D:/0_1_software_package/R包/GenomicRanges_1.56.0.zip", repos = NULL, type = "win.binary")
library(this.path)
setwd(this.path::this.dir())
#setwd('D:/1_1_Work_Path/8_3_cGAS_3/2_1_annotation/1_1_overlap')
library(ChIPseeker)
library(clusterProfiler)
library(TxDb.Hsapiens.UCSC.hg19.knownGene)
library(org.Hs.eg.db)
txdb <- TxDb.Hsapiens.UCSC.hg19.knownGene
peak <- readPeakFile("./0_4_Cut_Tag_cGAS_overlap.peak.chr24.narrowPeak")
peakAnno <- annotatePeak(peak, tssRegion = c(-3000, 3000),
TxDb = txdb,annoDb="org.Hs.eg.db")
plotAnnoPie(peakAnno,cex=0.7,radius=0.75)
library(this.path)
setwd(this.path::this.dir())
#setwd('D:/1_1_Work_Path/8_3_cGAS_3/2_1_annotation/1_2_union')
library(ChIPseeker)
library(clusterProfiler)
library(TxDb.Hsapiens.UCSC.hg19.knownGene)
library(org.Hs.eg.db)
txdb <- TxDb.Hsapiens.UCSC.hg19.knownGene
peak <- readPeakFile("./0_4_Cut_Tag_cGAS_union.peak.chr24.narrowPeak")
peakAnno <- annotatePeak(peak, tssRegion = c(-3000, 3000),
TxDb = txdb,annoDb="org.Hs.eg.db")
plotAnnoPie(peakAnno,cex=0.7,radius=0.75)
library(this.path)
setwd(this.path::this.dir())
library(ChIPseeker)
library(clusterProfiler)
library(TxDb.Hsapiens.UCSC.hg19.knownGene)
library(org.Hs.eg.db)
library(ggplot2)
library(stringr)
library(ggpubr)
data1 = readPeakFile("0_1.cGAS_R1.24chr.narrowPeak")
data1 = readPeakFile("0_1.cGAS_R1.24chr.narrowPeak")
library(this.path)
setwd(this.path::this.dir())
library(ChIPseeker)
library(clusterProfiler)
library(TxDb.Hsapiens.UCSC.hg19.knownGene)
library(org.Hs.eg.db)
library(ggplot2)
library(stringr)
library(ggpubr)
data1 = readPeakFile("0_1.cGAS_R1.24chr.narrowPeak")
library(this.path)
setwd(this.path::this.dir())
library(ChIPseeker)
library(clusterProfiler)
library(TxDb.Hsapiens.UCSC.hg19.knownGene)
library(org.Hs.eg.db)
library(ggplot2)
library(stringr)
library(ggpubr)
data1 = readPeakFile("0_1.cGAS_R1.24chr.narrowPeak")
data2 = readPeakFile("0_2.cGAS_R2.24chr.narrowPeak")
covplot(data1,weightCol="V5", chrs = c("chr1", "chr2","chr3","chr4","chr5"))
covplot(data2,weightCol="V5", chrs = c("chr1", "chr2","chr3","chr4","chr5"))
covplot(data1,weightCol="V5", chrs = c("chr1"))
covplot(data2,weightCol="V5", chrs = c("chr1"))
library(this.path)
setwd(this.path::this.dir())
library(ChIPseeker)
library(clusterProfiler)
library(TxDb.Hsapiens.UCSC.hg19.knownGene)
library(org.Hs.eg.db)
txdb <- TxDb.Hsapiens.UCSC.hg19.knownGene
peak <- readPeakFile("./0_4_Cut_Tag_cGAS_union.peak.chr24.narrowPeak")
peakAnno <- annotatePeak(peak, tssRegion = c(-3000, 3000),
TxDb = txdb,annoDb="org.Hs.eg.db")
write.table(as.data.frame(peakAnno),file="1_1_peaks.annotate.tsv",
sep='\t',quote = F, row.names = FALSE)
pdf('1_1_pieplot_anno.pdf', width = 11.69, height = 8.27)
plotAnnoPie(peakAnno,cex=0.7,radius=0.75)
dev.off()
library(this.path)
setwd(this.path::this.dir())
#setwd('D:/1_1_Work_Path/1_1_YuanLin/1_1_cGAS/8_5_cGAS_6/F2D')
library(clusterProfiler)
library(TxDb.Hsapiens.UCSC.hg19.knownGene)
library(org.Hs.eg.db)
library(ggplot2)
library(stringr)
library(ChIPseeker)
library(ggpubr)
txdb <- TxDb.Hsapiens.UCSC.hg19.knownGene
sample_lab = "2_1_genelist.promoter"
gene_list_file <- paste0(sample_lab,".tsv")
ego_out_file <- paste0("3_1_ego_", sample_lab, ".tsv")
kegg_out_file <- paste0("4_1_kegg_", sample_lab, ".tsv")
ego_out_pdf <- paste0("3_1_ego_", sample_lab, ".pdf")
kegg_out_pdf <- paste0("4_1_kegg_", sample_lab, ".pdf")
data = read.csv(gene_list_file, sep='\t')
gene = data$geneId
# F2D
kegg <- enrichKEGG(
gene = gene,
keyType = 'kegg',
organism = 'human',
pvalueCutoff = 0.05,
)
View(kegg)
library(this.path)
setwd(this.path::this.dir())
#setwd('D:/1_1_Work_Path/1_1_YuanLin/1_1_cGAS/8_5_cGAS_6/F2D')
library(clusterProfiler)
library(TxDb.Hsapiens.UCSC.hg19.knownGene)
library(org.Hs.eg.db)
library(ggplot2)
library(stringr)
library(ChIPseeker)
library(ggpubr)
txdb <- TxDb.Hsapiens.UCSC.hg19.knownGene
sample_lab = "2_1_genelist.promoter"
gene_list_file <- paste0(sample_lab,".tsv")
ego_out_file <- paste0("3_1_ego_", sample_lab, ".tsv")
kegg_out_file <- paste0("4_1_kegg_", sample_lab, ".tsv")
ego_out_pdf <- paste0("3_1_ego_", sample_lab, ".pdf")
kegg_out_pdf <- paste0("4_1_kegg_", sample_lab, ".pdf")
data = read.csv(gene_list_file, sep='\t')
gene = data$geneId
# F2D
kegg <- enrichKEGG(
gene = gene,
keyType = 'kegg',
organism = 'human',
pvalueCutoff = 0.05,
)
dotplot(kegg,
color = (c("pvalue")))
library(this.path)
setwd(this.path::this.dir())
library(ChIPseeker)
library(clusterProfiler)
library(TxDb.Hsapiens.UCSC.hg19.knownGene)
library(org.Hs.eg.db)
library(ggplot2)
library(stringr)
library(ggpubr)
txdb <- TxDb.Hsapiens.UCSC.hg19.knownGene
peak <- readPeakFile("./0_4_Cut_Tag_cGAS_union.peak.chr24.narrowPeak")
peakAnno <- annotatePeak(peak, tssRegion = c(-3000, 3000),
TxDb = txdb,annoDb="org.Hs.eg.db")
write.table(as.data.frame(peakAnno),file="1_1_peaks.annotate.tsv",
sep='\t',quote = F, row.names = FALSE)
#F3C
pdf('1_1_pieplot_anno.pdf', width = 11.69, height = 8.27)
plotAnnoPie(peakAnno,cex=0.7,radius=0.75)
dev.off()
sample_lab = "2_1_genelist.promoter"
gene_list_file <- paste0(sample_lab,".tsv")
kegg_out_file <- paste0("4_1_kegg_", sample_lab, ".tsv")
kegg_out_pdf <- paste0("4_1_kegg_", sample_lab, ".pdf")
data = read.csv(gene_list_file, sep='\t')
gene = data$geneId
# F3D
kegg <- enrichKEGG(
gene = gene,
keyType = 'kegg',
organism = 'human',
pvalueCutoff = 0.05,
)
dotplot(kegg,
color = (c("pvalue")))
sample_lab = "2_1_genelist.promoter"
gene_list_file <- paste0(sample_lab,".tsv")
kegg_out_file <- paste0("4_1_kegg_", sample_lab, ".tsv")
kegg_out_pdf <- paste0("4_1_kegg_", sample_lab, ".pdf")
data = read.csv(gene_list_file, sep='\t')
gene = data$geneId
# F3D
kegg <- enrichKEGG(
gene = gene,
keyType = 'kegg',
organism = 'human',
pvalueCutoff = 0.05,
)
dotplot(kegg,
color = (c("pvalue")))
library(this.path)
setwd(this.path::this.dir())
#setwd('D:/1_1_Work_Path/1_1_YuanLin/1_1_cGAS/8_5_cGAS_6/F2D')
library(clusterProfiler)
library(TxDb.Hsapiens.UCSC.hg19.knownGene)
library(org.Hs.eg.db)
library(ggplot2)
library(stringr)
library(ChIPseeker)
library(ggpubr)
txdb <- TxDb.Hsapiens.UCSC.hg19.knownGene
sample_lab = "2_1_genelist.promoter"
gene_list_file <- paste0(sample_lab,".tsv")
ego_out_file <- paste0("3_1_ego_", sample_lab, ".tsv")
kegg_out_file <- paste0("4_1_kegg_", sample_lab, ".tsv")
ego_out_pdf <- paste0("3_1_ego_", sample_lab, ".pdf")
kegg_out_pdf <- paste0("4_1_kegg_", sample_lab, ".pdf")
data = read.csv(gene_list_file, sep='\t')
gene = data$geneId
# F2D
kegg <- enrichKEGG(
gene = gene,
keyType = 'kegg',
organism = 'human',
pvalueCutoff = 0.05,
)
dotplot(kegg,
color = (c("pvalue")))
library(this.path)
setwd(this.path::this.dir())
#setwd('D:/1_1_Work_Path/1_1_YuanLin/1_1_cGAS/8_5_cGAS_6/F2D')
library(clusterProfiler)
library(TxDb.Hsapiens.UCSC.hg19.knownGene)
library(org.Hs.eg.db)
library(ggplot2)
library(stringr)
library(ChIPseeker)
library(ggpubr)
txdb <- TxDb.Hsapiens.UCSC.hg19.knownGene
sample_lab = "2_1_genelist.promoter"
gene_list_file <- paste0(sample_lab,".tsv")
ego_out_file <- paste0("3_1_ego_", sample_lab, ".tsv")
kegg_out_file <- paste0("4_1_kegg_", sample_lab, ".tsv")
ego_out_pdf <- paste0("3_1_ego_", sample_lab, ".pdf")
kegg_out_pdf <- paste0("4_1_kegg_", sample_lab, ".pdf")
data = read.csv(gene_list_file, sep='\t')
gene = data$geneId
# F2D
kegg <- enrichKEGG(
gene = gene,
keyType = 'kegg',
organism = 'human',
pvalueCutoff = 0.05,
)
dotplot(kegg,
color = (c("pvalue")))
library(this.path)
setwd(this.path::this.dir())
#setwd('D:/1_1_Work_Path/8_5_cGAS_5/F2CS5E')
library(clusterProfiler)
library(TxDb.Hsapiens.UCSC.hg19.knownGene)
library(org.Hs.eg.db)
library(ggplot2)
library(stringr)
library(ggpubr)
library(ChIPseeker)
txdb <- TxDb.Hsapiens.UCSC.hg19.knownGene
sample_lab = "down"
gene_list_file <- paste0(sample_lab,".list")
data = read.csv(gene_list_file, sep='\t')
gene = data$geneId
ego <- enrichGO(gene = gene,
keyType = "ENTREZID",
OrgDb = org.Hs.eg.db,
ont = "BP",
pvalueCutoff = 0.05,
qvalueCutoff = 0.05,
readable = TRUE)
write.table(ego@result,
file = "down_BP.tsv",
sep = "\t",
row.names = F,col.names = T, quote = FALSE)
p1 <- barplot(ego,color = (c("qvalue")))+
theme_bw()+ theme(panel.grid=element_blank())
p2 <- dotplot(ego,color = (c("qvalue")))+
theme_bw()+ theme(panel.grid=element_blank())
p5 <- ggpar(p1, font.y=c(8), font.tickslab=c(8), font.legend=c(8),legend = "right", legend.title="Database")
p5
p4 <- ggpar(p2, font.y=c(8), font.tickslab=c(8), font.legend=c(8),legend = "right", legend.title="Database")
p4
library(this.path)
setwd(this.path::this.dir())
library(clusterProfiler)
library(TxDb.Hsapiens.UCSC.hg19.knownGene)
library(org.Hs.eg.db)
library(ggplot2)
library(stringr)
library(ggpubr)
library(ChIPseeker)
txdb <- TxDb.Hsapiens.UCSC.hg19.knownGene
sample_lab = "down"
gene_list_file <- paste0(sample_lab,".list")
data = read.csv(gene_list_file, sep='\t')
gene = data$geneId
ego <- enrichGO(gene = gene,
keyType = "ENTREZID",
OrgDb = org.Hs.eg.db,
ont = "BP",
pvalueCutoff = 0.05,
qvalueCutoff = 0.05,
readable = TRUE)
write.table(ego@result,
file = "down_BP.tsv",
sep = "\t",
row.names = F,col.names = T, quote = FALSE)
p1 <- barplot(ego,color = (c("qvalue")))+
theme_bw()+ theme(panel.grid=element_blank())
p2 <- dotplot(ego,color = (c("qvalue")))+
theme_bw()+ theme(panel.grid=element_blank())
p5 <- ggpar(p1, font.y=c(8), font.tickslab=c(8), font.legend=c(8),legend = "right", legend.title="Database")
p5
p4 <- ggpar(p2, font.y=c(8), font.tickslab=c(8), font.legend=c(8),legend = "right", legend.title="Database")
# Fig3E
p4
